"use strict";(()=>{var e={};e.id=22,e.ids=[22],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},1837:(e,o,r)=>{r.r(o),r.d(o,{originalPathname:()=>h,patchFetch:()=>O,requestAsyncStorage:()=>c,routeModule:()=>d,serverHooks:()=>m,staticGenerationAsyncStorage:()=>l});var t={};r.r(t),r.d(t,{POST:()=>u});var s=r(9303),a=r(8716),i=r(670),n=r(7070),p=r(2663);async function u(e){try{let o=await e.json();if(console.log("[DODO WEBHOOK] Received event:",o),"payment_success"===o.type&&o.customer?.email){let e=o.customer.email.toLowerCase();return await p._.user.updateMany({where:{email:e},data:{isPremium:!0}}),console.log(`[DODO WEBHOOK] Upgraded user to premium: ${e}`),n.NextResponse.json({success:!0})}return n.NextResponse.json({received:!0})}catch(e){return console.error("[DODO WEBHOOK] Error:",e),n.NextResponse.json({error:"Webhook error"},{status:500})}}let d=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/dodo-webhook/route",pathname:"/api/dodo-webhook",filename:"route",bundlePath:"app/api/dodo-webhook/route"},resolvedPagePath:"C:\\Users\\mdoma\\Desktop\\recipe\\app\\api\\dodo-webhook\\route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:c,staticGenerationAsyncStorage:l,serverHooks:m}=d,h="/api/dodo-webhook/route";function O(){return(0,i.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:l})}},2663:(e,o,r)=>{r.d(o,{_:()=>s});let t=require("@prisma/client"),s=globalThis.prisma??new t.PrismaClient},9303:(e,o,r)=>{e.exports=r(517)}};var o=require("../../../webpack-runtime.js");o.C(e);var r=e=>o(o.s=e),t=o.X(0,[510],()=>r(1837));module.exports=t})();